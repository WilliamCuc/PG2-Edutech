{% extends 'base.html' %}
{% block title %}Mis Calificaciones{% endblock %}

{% block content %}
<div class="bg-white p-8 rounded-lg shadow-md max-w-4xl mx-auto">
    {% if calificaciones_agrupadas %}
        <div class="space-y-8">
            {% for curso, data in calificaciones_agrupadas.items %}
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4 border-b pb-2">
                    {{ curso }}
                </h2>
                <div class="space-y-4">
                    {% for entrega in data.entregas %}
                    <div class="border rounded-lg p-4 flex justify-between items-center">
                        <div>
                            <p class="font-medium text-gray-800">{{ entrega.actividad.titulo }}</p>
                            <p class="text-sm text-gray-500">...</p>
                        </div>
                        <div class="text-right">
                            <p class="text-xl font-bold text-blue-600">{{ entrega.calificacion }}</p>
                            <a href="{% url 'actividad_detail' entrega.actividad.pk %}" class="text-xs text-indigo-600 hover:underline">
                                Ver Detalles
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <div class="mt-4 p-4 bg-gray-50 rounded-lg flex justify-end">
                    <p class="text-lg font-bold text-gray-800">
                        Promedio del Curso:
                        <span class="text-blue-600 ml-2">
                            {{ data.promedio|floatformat:2 }}
                        </span>
                    </p>
                </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-gray-500">No tienes calificaciones disponibles.</p>
    {% endif %}
    <div class="mt-8">
        {% if es_padre %}
            <a href="{% url 'portal_padre_ver_estudiante' estudiante.pk %}" class="text-gray-600 hover:text-gray-900">
                ← Volver al Portal de {{ estudiante.user.first_name }}
            </a>
        {% else %}
            <a href="{% url 'portal_estudiante' %}" class="text-gray-600 hover:text-gray-900">
                ← Volver al Portal
            </a>
        {% endif %}
    </div>
</div>
{% endblock %}